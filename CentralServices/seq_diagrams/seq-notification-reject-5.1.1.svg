<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="797px" preserveAspectRatio="none" style="width:874px;height:797px;" version="1.1" viewBox="0 0 874 797" width="874px" zoomAndPan="magnify"><defs><filter height="300%" id="f141wrn2s8c9br" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="294" x="291.25" y="23.5352">5.1.1. Notification Handler for Rejections</text><rect fill="#D3D3D3" height="752.0957" style="stroke: #A80036; stroke-width: 1.0;" width="186" x="4" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="7" y="47.0566">Financial Service Providers</text><rect fill="#ADD8E6" height="752.0957" style="stroke: #A80036; stroke-width: 1.0;" width="241" x="280" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="322" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="752.0957" style="stroke: #A80036; stroke-width: 1.0;" width="299" x="538.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="637.5" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#f141wrn2s8c9br)" height="510.832" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="395.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f141wrn2s8c9br)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="755" y="224.0859"/><rect fill="#FFFFFF" filter="url(#f141wrn2s8c9br)" height="495.832" style="stroke: #000000; stroke-width: 2.0;" width="801" x="62.5" y="170.7754"/><rect fill="#FFFFFF" filter="url(#f141wrn2s8c9br)" height="77.9316" style="stroke: #000000; stroke-width: 2.0;" width="589.5" x="264" y="269.707"/><rect fill="#FFFFFF" filter="url(#f141wrn2s8c9br)" height="46.6211" style="stroke: #000000; stroke-width: 2.0;" width="569.5" x="274" y="294.0176"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="96.5" x2="96.5" y1="153.7754" y2="683.6074"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="400" x2="400" y1="153.7754" y2="683.6074"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="609.5" x2="609.5" y1="153.7754" y2="683.6074"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="759.5" x2="759.5" y1="153.7754" y2="683.6074"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="72.5" y="134.334">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="75.5" y="150.8223">Payer</text><ellipse cx="97" cy="63.7988" fill="#FEFECE" filter="url(#f141wrn2s8c9br)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M97,71.7988 L97,98.7988 M84,79.7988 L110,79.7988 M97,98.7988 L84,113.7988 M97,98.7988 L110,113.7988 " fill="none" filter="url(#f141wrn2s8c9br)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="72.5" y="696.1426">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="75.5" y="712.6309">Payer</text><ellipse cx="97" cy="725.584" fill="#FEFECE" filter="url(#f141wrn2s8c9br)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M97,733.584 L97,760.584 M84,741.584 L110,741.584 M97,760.584 L84,775.584 M97,760.584 L110,775.584 " fill="none" filter="url(#f141wrn2s8c9br)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="284" y="150.8223">ML API Notification Event Handler</text><ellipse cx="400.5" cy="121.2871" fill="#FEFECE" filter="url(#f141wrn2s8c9br)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="396.5,109.2871,402.5,104.2871,400.5,109.2871,402.5,114.2871,396.5,109.2871" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="284" y="696.1426">ML API Notification Event Handler</text><ellipse cx="400.5" cy="715.0957" fill="#FEFECE" filter="url(#f141wrn2s8c9br)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="396.5,703.0957,402.5,698.0957,400.5,703.0957,402.5,708.0957,396.5,703.0957" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="542.5" y="150.8223">Central Service API</text><path d="M589,109.2871 L589,133.2871 M589,121.2871 L606,121.2871 " fill="none" filter="url(#f141wrn2s8c9br)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="618" cy="121.2871" fill="#FEFECE" filter="url(#f141wrn2s8c9br)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="542.5" y="696.1426">Central Service API</text><path d="M589,703.0957 L589,727.0957 M589,715.0957 L606,715.0957 " fill="none" filter="url(#f141wrn2s8c9br)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="618" cy="715.0957" fill="#FEFECE" filter="url(#f141wrn2s8c9br)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f141wrn2s8c9br)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="690.5" y="114.2871"/><rect fill="#FEFECE" filter="url(#f141wrn2s8c9br)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="686.5" y="118.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="693.5" y="138.8223">Notification-Topic</text><rect fill="#FEFECE" filter="url(#f141wrn2s8c9br)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="690.5" y="682.6074"/><rect fill="#FEFECE" filter="url(#f141wrn2s8c9br)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="686.5" y="686.6074"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="693.5" y="707.1426">Notification-Topic</text><rect fill="#FFFFFF" filter="url(#f141wrn2s8c9br)" height="510.832" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="395.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f141wrn2s8c9br)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="755" y="224.0859"/><path d="M62.5,170.7754 L279.5,170.7754 L279.5,177.7754 L269.5,187.7754 L62.5,187.7754 L62.5,170.7754 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="495.832" style="stroke: #000000; stroke-width: 2.0;" width="801" x="62.5" y="170.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="172" x="77.5" y="184.3438">DFSP Notified of Rejection</text><polygon fill="#A80036" points="743,220.0859,753,224.0859,743,228.0859,747,224.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405.5" x2="749" y1="224.0859" y2="224.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="412.5" y="212.3096">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="425.5" y="204.6543">Consume Notification event message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="429.5" y="219.9648"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="429.5" y="219.9648">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="506.5" y="219.9648">2001</text><path d="M264,269.707 L348,269.707 L348,276.707 L338,286.707 L264,286.707 L264,269.707 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="77.9316" style="stroke: #000000; stroke-width: 2.0;" width="589.5" x="264" y="269.707"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="279" y="283.2754">break</text><path d="M274,294.0176 L416,294.0176 L416,301.0176 L406,311.0176 L274,311.0176 L274,294.0176 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="46.6211" style="stroke: #000000; stroke-width: 2.0;" width="569.5" x="274" y="294.0176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="289" y="307.5859">Validate Event</text><polygon fill="#A80036" points="416.5,328.3281,406.5,332.3281,416.5,336.3281,412.5,332.3281" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="748,328.3281,758,332.3281,748,336.3281,752,332.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="410.5" x2="754" y1="332.3281" y2="332.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="422.5" y="327.8965">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="273" x="435.5" y="327.8965">Validate event - Rule: type == 'notification'</text><polygon fill="#A80036" points="597.5,371.6387,607.5,375.6387,597.5,379.6387,601.5,375.6387" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405.5" x2="603.5" y1="375.6387" y2="375.6387"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="412.5" y="371.207">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="425.5" y="371.207">Request Participant details</text><rect fill="#FFFFFF" filter="url(#f141wrn2s8c9br)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="394.5" x="281" y="383.9492"/><polygon fill="#EEEEEE" points="281,383.9492,345,383.9492,345,390.9492,335,400.9492,281,400.9492,281,383.9492" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="294" y="398.5176">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="242" x="357.25" y="417.5176">Get Participant Callback Details {3.1.0}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="361.25" y="432.8281"/><path d="M410,449.8809 L410,612.8809 L719,612.8809 L719,459.8809 L709,449.8809 L410,449.8809 " fill="#FFFF00" filter="url(#f141wrn2s8c9br)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M709,449.8809 L709,459.8809 L719,459.8809 L709,449.8809 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="416" y="467.4492">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="416" y="482.7598">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="432" y="498.0703">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="432" y="513.3809">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="432" y="528.6914">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="432" y="544.002">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="432" y="559.3125">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="448" y="574.623">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="432" y="589.9336">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="416" y="605.2441">}</text><polygon fill="#A80036" points="108,653.9863,98,657.9863,108,661.9863,104,657.9863" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="102" x2="394.5" y1="657.9863" y2="657.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="114" y="646.21">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="127" y="638.5547">Send callback notification</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="131" y="653.8652"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="131" y="653.8652">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="208" y="653.8652">1000, 1001, 3002</text><!--
@startuml
title 5.1.1. Notification Handler for Rejections

autonumber


actor "DFSP1\nPayer" as DFSP1
control "ML API Notification Event Handler" as NOTIFY_HANDLER
boundary "Central Service API" as CSAPI
collections "Notification-Topic" as TOPIC_NOTIFICATIONS

box "Financial Service Providers" #lightGray
	participant DFSP1
end box

box "ML API Adapter Service" #LightBlue
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant CSAPI
    participant TOPIC_NOTIFICATIONS
end box

activate NOTIFY_HANDLER
group DFSP Notified of Rejection
    NOTIFY_HANDLER -> TOPIC_NOTIFICATIONS: Consume Notification event message \n <color #FF0000><b>Error code:</b> 2001 </color>
    activate TOPIC_NOTIFICATIONS
    deactivate TOPIC_NOTIFICATIONS
        break
            group Validate Event
                NOTIFY_HANDLER <-> TOPIC_NOTIFICATIONS: Validate event - Rule: type == 'notification'
            end
        end
    NOTIFY_HANDLER -> CSAPI: Request Participant details
    ref over NOTIFY_HANDLER, CSAPI: Get Participant Callback Details {3.1.0} \n
        note right of NOTIFY_HANDLER #yellow
            Message:
            {
                id: <ID>,
                from: <transferHeaders.FSPIOP-Source>,
                to: <transferHeaders.FSPIOP-Destination>,
                type: application/json,
                content: {
                    payload: <transferMessage>
                },
            }
        end note

    NOTIFY_HANDLER -> DFSP1: Send callback notification \n <color #FF0000><b>Error code:</b> 1000, 1001, 3002 </color>
end
deactivate TOPIC_NOTIFICATIONS

@enduml

PlantUML version 1.2018.01(Sun Jan 28 20:08:22 SAST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1136-b29
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>