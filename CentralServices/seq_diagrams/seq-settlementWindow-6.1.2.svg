<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="359.4px" preserveAspectRatio="none" style="width:471px;height:359px;" version="1.1" viewBox="0 0 471 359" width="471px" zoomAndPan="magnify"><defs><filter height="300%" id="f1wm2tdckxyb0l" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="1.2000000476837158"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="2.4000000953674316" dy="2.4000000953674316" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="149.4" x="165.3" y="14.1211">6.1.1. Creation of Settlement Event</text><rect fill="#FFB6C1" height="332.3672" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="73.2" x="11.4" y="20.693"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51.6" x="22.2" y="28.234">Central Bank</text><rect fill="#90EE90" height="332.3672" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="187.2" x="85.8" y="20.693"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="74.4" x="142.2" y="28.234">Settlement Service</text><rect fill="#FFFFE0" height="332.3672" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="174.3" x="274.2" y="20.693"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="64.8" x="328.95" y="28.234">Central Services</text><rect fill="#FFFFFF" filter="url(#f1wm2tdckxyb0l)" height="206.7949" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="226.5" y="88.3723"/><rect fill="#FFFFFF" filter="url(#f1wm2tdckxyb0l)" height="37.159" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="269.7" x="182.4" y="142.3313"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="48" x2="48" y1="82.3723" y2="301.1672"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="135" x2="135" y1="82.3723" y2="301.1672"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="229.2" x2="229.2" y1="82.3723" y2="301.1672"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="316.8" x2="316.8" y1="82.3723" y2="301.1672"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="417.3" x2="417.3" y1="82.3723" y2="301.1672"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="64.8" x="13.8" y="80.6004">Hub Operations</text><ellipse cx="48" cy="38.2793" fill="#FEFECE" filter="url(#f1wm2tdckxyb0l)" rx="4.8" ry="4.8" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><path d="M48,43.0793 L48,59.2793 M40.2,47.8793 L55.8,47.8793 M48,59.2793 L40.2,68.2793 M48,59.2793 L55.8,68.2793 " fill="none" filter="url(#f1wm2tdckxyb0l)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="64.8" x="13.8" y="308.6883">Hub Operations</text><ellipse cx="48" cy="316.4602" fill="#FEFECE" filter="url(#f1wm2tdckxyb0l)" rx="4.8" ry="4.8" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><path d="M48,321.2602 L48,337.4602 M40.2,326.0602 L55.8,326.0602 M48,337.4602 L40.2,346.4602 M48,337.4602 L55.8,346.4602 " fill="none" filter="url(#f1wm2tdckxyb0l)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="90.6" x="88.2" y="80.6004">Settlement Service API</text><path d="M123,55.6793 L123,70.0793 M123,62.8793 L133.2,62.8793 " fill="none" filter="url(#f1wm2tdckxyb0l)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><ellipse cx="140.4" cy="62.8793" fill="#FEFECE" filter="url(#f1wm2tdckxyb0l)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="90.6" x="88.2" y="308.6883">Settlement Service API</text><path d="M123,312.8602 L123,327.2602 M123,320.0602 L133.2,320.0602 " fill="none" filter="url(#f1wm2tdckxyb0l)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><ellipse cx="140.4" cy="320.0602" fill="#FEFECE" filter="url(#f1wm2tdckxyb0l)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="78.6" x="188.4" y="80.6004">Settlement Window</text><ellipse cx="229.5" cy="62.8793" fill="#FEFECE" filter="url(#f1wm2tdckxyb0l)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><polygon fill="#A80036" points="227.1,55.6793,230.7,52.6793,229.5,55.6793,230.7,58.6793,227.1,55.6793" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="78.6" x="188.4" y="308.6883">Settlement Window</text><ellipse cx="229.5" cy="320.0602" fill="#FEFECE" filter="url(#f1wm2tdckxyb0l)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><polygon fill="#A80036" points="227.1,312.8602,230.7,309.8602,229.5,312.8602,230.7,315.8602,227.1,312.8602" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="76.8" x="276.6" y="80.6004">Central Service API</text><path d="M304.5,55.6793 L304.5,70.0793 M304.5,62.8793 L314.7,62.8793 " fill="none" filter="url(#f1wm2tdckxyb0l)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><ellipse cx="321.9" cy="62.8793" fill="#FEFECE" filter="url(#f1wm2tdckxyb0l)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="76.8" x="276.6" y="308.6883">Central Service API</text><path d="M304.5,312.8602 L304.5,327.2602 M304.5,320.0602 L314.7,320.0602 " fill="none" filter="url(#f1wm2tdckxyb0l)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><ellipse cx="321.9" cy="320.0602" fill="#FEFECE" filter="url(#f1wm2tdckxyb0l)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="54" x="388.5" y="80.6004">Central Store</text><path d="M406.5,50.8793 C406.5,44.8793 417.3,44.8793 417.3,44.8793 C417.3,44.8793 428.1,44.8793 428.1,50.8793 L428.1,66.4793 C428.1,72.4793 417.3,72.4793 417.3,72.4793 C417.3,72.4793 406.5,72.4793 406.5,66.4793 L406.5,50.8793 " fill="#FEFECE" filter="url(#f1wm2tdckxyb0l)" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><path d="M406.5,50.8793 C406.5,56.8793 417.3,56.8793 417.3,56.8793 C417.3,56.8793 428.1,56.8793 428.1,50.8793 " fill="none" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="54" x="388.5" y="308.6883">Central Store</text><path d="M406.5,316.4602 C406.5,310.4602 417.3,310.4602 417.3,310.4602 C417.3,310.4602 428.1,310.4602 428.1,316.4602 L428.1,332.0602 C428.1,338.0602 417.3,338.0602 417.3,338.0602 C417.3,338.0602 406.5,338.0602 406.5,332.0602 L406.5,316.4602 " fill="#FEFECE" filter="url(#f1wm2tdckxyb0l)" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><path d="M406.5,316.4602 C406.5,322.4602 417.3,322.4602 417.3,322.4602 C417.3,322.4602 428.1,322.4602 428.1,316.4602 " fill="none" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><rect fill="#FFFFFF" filter="url(#f1wm2tdckxyb0l)" height="206.7949" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="226.5" y="88.3723"/><polygon fill="#A80036" points="219.3,113.1586,225.3,115.5586,219.3,117.9586,221.7,115.5586" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="48" x2="222.9" y1="115.5586" y2="115.5586"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="52.2" y="112.8996">1</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="90.6" x="60" y="112.8996">Settlement event trigger</text><polygon fill="#A80036" points="410.1,130.7449,416.1,133.1449,410.1,135.5449,412.5,133.1449" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="232.5" x2="413.7" y1="133.1449" y2="133.1449"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="236.7" y="130.4859">2</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="105.6" x="244.5" y="130.4859">Get open settlementWindow</text><path d="M182.4,142.3313 L275.4,142.3313 L275.4,146.5313 L269.4,152.5313 L182.4,152.5313 L182.4,142.3313 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="37.159" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="269.7" x="182.4" y="142.3313"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="66" x="191.4" y="150.4723">Validation Event</text><polygon fill="#A80036" points="410.1,171.9176,416.1,174.3176,410.1,176.7176,412.5,174.3176" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="232.5" x2="413.7" y1="174.3176" y2="174.3176"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="236.7" y="167.2518">3</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="162.6" x="244.5" y="162.6586">Check for Settlement Windows that is open</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="66.6" x="246.9" y="171.8449">Rule: state: 'open'</text><path d="M235.2,186.6902 L235.2,238.2902 L463.8,238.2902 L463.8,192.6902 L457.8,186.6902 L235.2,186.6902 " fill="#ADD8E6" filter="url(#f1wm2tdckxyb0l)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M457.8,186.6902 L457.8,192.6902 L463.8,192.6902 L457.8,186.6902 " fill="#ADD8E6" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="126" x="238.8" y="197.2313">Processing within DB Transaction</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="176.4" x="238.8" y="206.4176">Check settlementWindow status 'closed' 'open'</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="195.6" x="238.8" y="215.6039">Check that all settlement windows are not allocated</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="216" x="238.8" y="224.7902">Check settlements in settlement window - updates to DB</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="189.6" x="238.8" y="233.9766">Check for settlement windows that can be 'closed'</text><path d="M235.2,247.0219 L235.2,289.6219 L459.6,289.6219 L459.6,253.0219 L453.6,247.0219 L235.2,247.0219 " fill="#ADD8E6" filter="url(#f1wm2tdckxyb0l)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M453.6,247.0219 L453.6,253.0219 L459.6,253.0219 L453.6,247.0219 " fill="#ADD8E6" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="99" x="238.8" y="257.5629">SettlementWindos ERRORS</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="195.6" x="238.8" y="266.7492">Check settlementWindow status != 'closed' || 'open'</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="211.8" x="238.8" y="275.9356">Check settlementWindow status == 'open' not allocated</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="0" x="241.2" y="285.1219"/><!--
@startuml
title 6.1.1. Creation of Settlement Event

autonumber



actor "Hub Operations" as OPERATOR

boundary "Settlement Service API" as SSAPI
control "Settlement Window" as SETTLEWINDOW

boundary "Central Service API" as CSAPI
database "Central Store" as DB

box "Central Bank" #LightPink
    participant OPERATOR
end box

box "Settlement Service" #LightGreen
    participant SSAPI
    participant SETTLEWINDOW
end box

box "Central Services" #LightYellow
    participant CSAPI
    participant DB
end box

activate SETTLEWINDOW

group Settlement Trigger received from "HUB"
    OPERATOR -> SETTLEWINDOW: Settlement event trigger
    SETTLEWINDOW -> DB: Get open settlementWindow
    group Validation Event
        SETTLEWINDOW -> DB: Check for Settlement Windows that is open\n Rule: state: 'open'
    end
    note right of SETTLEWINDOW #lightblue
        Processing within DB Transaction
        Check settlementWindow status 'closed' 'open'
        Check that all settlement windows are not allocated
        Check settlements in settlement window - updates to DB
        Check for settlement windows that can be 'closed'
    end note
    note right of SETTLEWINDOW #lightblue
        SettlementWindos ERRORS
        Check settlementWindow status != 'closed' || 'open'
        Check settlementWindow status == 'open' not allocated

    end note


deactivate SETTLEWINDOW
@enduml

PlantUML version 1.2018.01(Sun Jan 28 20:08:22 SAST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1136-b29
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>