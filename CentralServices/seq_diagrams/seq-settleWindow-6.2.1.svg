<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="676.2px" preserveAspectRatio="none" style="width:742px;height:676px;" version="1.1" viewBox="0 0 742 676" width="742.2px" zoomAndPan="magnify"><defs><filter height="300%" id="f1jp1rbgdo1kgi" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="1.2000000476837158"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="2.4000000953674316" dy="2.4000000953674316" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157.8" x="292.8" y="14.1211">6.1.2. POST:: closeSettlementWindow</text><rect fill="#FFB6C1" height="649.4942" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="67.2" x="17.4" y="20.693"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="48.6" x="26.7" y="28.234">Central HUB</text><rect fill="#90EE90" height="649.4942" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="420.6" x="85.8" y="20.693"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="74.4" x="258.9" y="28.234">Settlement Service</text><rect fill="#FFFFE0" height="649.4942" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="181.8" x="507.6" y="20.693"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="64.8" x="566.1" y="28.234">Central Services</text><rect fill="#FFFFFF" filter="url(#f1jp1rbgdo1kgi)" height="497.3356" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="226.8" y="115.5586"/><rect fill="#FFFFFF" filter="url(#f1jp1rbgdo1kgi)" height="91.5316" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="449.4" y="226.4356"/><rect fill="#FFFFFF" filter="url(#f1jp1rbgdo1kgi)" height="151.8633" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="449.4" y="335.5535"/><rect fill="#FFFFFF" filter="url(#f1jp1rbgdo1kgi)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="655.2" y="253.0219"/><rect fill="#FFFFFF" filter="url(#f1jp1rbgdo1kgi)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="655.2" y="362.1399"/><rect fill="#FFFFFF" filter="url(#f1jp1rbgdo1kgi)" height="515.5219" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="727.8" x="7.8" y="92.5723"/><rect fill="#FFFFFF" filter="url(#f1jp1rbgdo1kgi)" height="400.4449" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="715.8" x="13.8" y="203.4492"/><rect fill="#FFFFFF" height="93.9047" style="stroke: none; stroke-width: 0.6000000238418579;" width="715.8" x="13.8" y="509.9895"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="51" x2="51" y1="82.3723" y2="618.2942"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="135" x2="135" y1="82.3723" y2="618.2942"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="229.5" x2="229.5" y1="82.3723" y2="618.2942"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="452.4" x2="452.4" y1="82.3723" y2="618.2942"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="550.2" x2="550.2" y1="82.3723" y2="618.2942"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="658.2" x2="658.2" y1="82.3723" y2="618.2942"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="58.8" x="19.8" y="80.6004">Hub Employee</text><ellipse cx="51" cy="38.2793" fill="#FEFECE" filter="url(#f1jp1rbgdo1kgi)" rx="4.8" ry="4.8" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><path d="M51,43.0793 L51,59.2793 M43.2,47.8793 L58.8,47.8793 M51,59.2793 L43.2,68.2793 M51,59.2793 L58.8,68.2793 " fill="none" filter="url(#f1jp1rbgdo1kgi)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="58.8" x="19.8" y="625.8153">Hub Employee</text><ellipse cx="51" cy="633.5871" fill="#FEFECE" filter="url(#f1jp1rbgdo1kgi)" rx="4.8" ry="4.8" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><path d="M51,638.3871 L51,654.5871 M43.2,643.1871 L58.8,643.1871 M51,654.5871 L43.2,663.5871 M51,654.5871 L58.8,663.5871 " fill="none" filter="url(#f1jp1rbgdo1kgi)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="90.6" x="88.2" y="80.6004">Settlement Service API</text><path d="M123,55.6793 L123,70.0793 M123,62.8793 L133.2,62.8793 " fill="none" filter="url(#f1jp1rbgdo1kgi)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><ellipse cx="140.4" cy="62.8793" fill="#FEFECE" filter="url(#f1jp1rbgdo1kgi)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="90.6" x="88.2" y="625.8153">Settlement Service API</text><path d="M123,629.9871 L123,644.3871 M123,637.1871 L133.2,637.1871 " fill="none" filter="url(#f1jp1rbgdo1kgi)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><ellipse cx="140.4" cy="637.1871" fill="#FEFECE" filter="url(#f1jp1rbgdo1kgi)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="78.6" x="188.7" y="80.6004">Settlement Window</text><ellipse cx="229.8" cy="62.8793" fill="#FEFECE" filter="url(#f1jp1rbgdo1kgi)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><polygon fill="#A80036" points="227.4,55.6793,231,52.6793,229.8,55.6793,231,58.6793,227.4,55.6793" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="78.6" x="188.7" y="625.8153">Settlement Window</text><ellipse cx="229.8" cy="637.1871" fill="#FEFECE" filter="url(#f1jp1rbgdo1kgi)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><polygon fill="#A80036" points="227.4,629.9871,231,626.9871,229.8,629.9871,231,632.9871,227.4,629.9871" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="99.6" x="400.8" y="80.6004">Settlement Window DAO</text><ellipse cx="452.4" cy="62.8793" fill="#FEFECE" filter="url(#f1jp1rbgdo1kgi)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><line style="stroke: #A80036; stroke-width: 1.2000000476837158;" x1="445.2" x2="459.6" y1="71.2793" y2="71.2793"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="99.6" x="400.8" y="625.8153">Settlement Window DAO</text><ellipse cx="452.4" cy="637.1871" fill="#FEFECE" filter="url(#f1jp1rbgdo1kgi)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><line style="stroke: #A80036; stroke-width: 1.2000000476837158;" x1="445.2" x2="459.6" y1="645.5871" y2="645.5871"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="76.8" x="510" y="80.6004">Central Service API</text><path d="M537.9,55.6793 L537.9,70.0793 M537.9,62.8793 L548.1,62.8793 " fill="none" filter="url(#f1jp1rbgdo1kgi)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><ellipse cx="555.3" cy="62.8793" fill="#FEFECE" filter="url(#f1jp1rbgdo1kgi)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="76.8" x="510" y="625.8153">Central Service API</text><path d="M537.9,629.9871 L537.9,644.3871 M537.9,637.1871 L548.1,637.1871 " fill="none" filter="url(#f1jp1rbgdo1kgi)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><ellipse cx="555.3" cy="637.1871" fill="#FEFECE" filter="url(#f1jp1rbgdo1kgi)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="54" x="629.4" y="80.6004">Central Store</text><path d="M647.4,50.8793 C647.4,44.8793 658.2,44.8793 658.2,44.8793 C658.2,44.8793 669,44.8793 669,50.8793 L669,66.4793 C669,72.4793 658.2,72.4793 658.2,72.4793 C658.2,72.4793 647.4,72.4793 647.4,66.4793 L647.4,50.8793 " fill="#FEFECE" filter="url(#f1jp1rbgdo1kgi)" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><path d="M647.4,50.8793 C647.4,56.8793 658.2,56.8793 658.2,56.8793 C658.2,56.8793 669,56.8793 669,50.8793 " fill="none" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="54" x="629.4" y="625.8153">Central Store</text><path d="M647.4,633.5871 C647.4,627.5871 658.2,627.5871 658.2,627.5871 C658.2,627.5871 669,627.5871 669,633.5871 L669,649.1871 C669,655.1871 658.2,655.1871 658.2,655.1871 C658.2,655.1871 647.4,655.1871 647.4,649.1871 L647.4,633.5871 " fill="#FEFECE" filter="url(#f1jp1rbgdo1kgi)" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><path d="M647.4,633.5871 C647.4,639.5871 658.2,639.5871 658.2,639.5871 C658.2,639.5871 669,639.5871 669,633.5871 " fill="none" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><rect fill="#FFFFFF" filter="url(#f1jp1rbgdo1kgi)" height="497.3356" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="226.8" y="115.5586"/><rect fill="#FFFFFF" filter="url(#f1jp1rbgdo1kgi)" height="91.5316" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="449.4" y="226.4356"/><rect fill="#FFFFFF" filter="url(#f1jp1rbgdo1kgi)" height="151.8633" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="449.4" y="335.5535"/><rect fill="#FFFFFF" filter="url(#f1jp1rbgdo1kgi)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="655.2" y="253.0219"/><rect fill="#FFFFFF" filter="url(#f1jp1rbgdo1kgi)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="655.2" y="362.1399"/><path d="M7.8,92.5723 L189.6,92.5723 L189.6,96.7723 L183.6,102.7723 L7.8,102.7723 L7.8,92.5723 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="515.5219" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="727.8" x="7.8" y="92.5723"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="154.8" x="16.8" y="100.7133">Request closure of Settlement Window</text><polygon fill="#A80036" points="219.6,113.1586,225.6,115.5586,219.6,117.9586,222,115.5586" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="51" x2="223.2" y1="115.5586" y2="115.5586"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="55.2" y="112.8996">1</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="144.6" x="63" y="112.8996">API call for settlement window closure</text><path d="M75.6,123.5449 L75.6,193.7449 L221.4,193.7449 L221.4,129.5449 L215.4,123.5449 L75.6,123.5449 " fill="#FFFF00" filter="url(#f1jp1rbgdo1kgi)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M215.4,123.5449 L215.4,129.5449 L221.4,129.5449 L215.4,123.5449 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="36.6" x="79.2" y="134.0859">Messages</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="124.2" x="79.2" y="143.2723">POST:: '/settlementWindows/{id}'</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="0" x="81.6" y="152.4586"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="79.2" y="161.6449">{</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="62.4" x="84" y="170.8313">"state": "closed",</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="128.4" x="84" y="180.0176">"reason": "motivation for closure."</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="79.2" y="189.2039">}</text><path d="M13.8,203.4492 L51,203.4492 L51,207.6492 L45,213.6492 L13.8,213.6492 L13.8,203.4492 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="400.4449" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="715.8" x="13.8" y="203.4492"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.2" x="22.8" y="211.5902">alt</text><polygon fill="#A80036" points="442.2,224.0356,448.2,226.4356,442.2,228.8356,444.6,226.4356" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="232.8" x2="445.8" y1="226.4356" y2="226.4356"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="237" y="223.7766">2</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="168" x="244.8" y="223.7766">Request settlementWindow status == 'close'</text><polygon fill="#A80036" points="648,250.6219,654,253.0219,648,255.4219,650.4,253.0219" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="455.4" x2="651.6" y1="253.0219" y2="253.0219"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="459.6" y="245.9561">3</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="164.4" x="467.4" y="241.3629">Update settlementWindow status == 'close'</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43.8" x="467.4" y="250.5492">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="513.6" y="250.5492">2001</text><polygon fill="#FFFFE0" filter="url(#f1jp1rbgdo1kgi)" points="598.8,279.1945,717.6,279.1945,723.6,290.5945,717.6,301.9945,598.8,301.9945,592.8,290.5945,598.8,279.1945" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="69.6" x="600" y="289.1356">settlementWindow</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="116.4" x="600" y="298.3219">settlementWindowStateChange</text><polygon fill="#A80036" points="239.4,315.5672,233.4,317.9672,239.4,320.3672,237,317.9672" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="235.8" x2="451.8" y1="317.9672" y2="317.9672"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="243" y="315.3082">4</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="57" x="250.8" y="315.3082">Return success</text><polygon fill="#A80036" points="442.2,333.1535,448.2,335.5535,442.2,337.9535,444.6,335.5535" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="232.8" x2="445.8" y1="335.5535" y2="335.5535"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="237" y="332.8945">5</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="197.4" x="244.8" y="332.8945">Request new settlementWindow &amp;&amp; status == 'open'</text><polygon fill="#A80036" points="648,359.7399,654,362.1399,648,364.5399,650.4,362.1399" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="455.4" x2="651.6" y1="362.1399" y2="362.1399"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="459.6" y="355.074">6</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="178.2" x="467.4" y="350.4809">Create new settlementWindow status == 'open'</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43.8" x="467.4" y="359.6672">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="513.6" y="359.6672">2001</text><path d="M235.8,388.3125 L235.8,439.9125 L396,439.9125 L396,394.3125 L390,388.3125 L235.8,388.3125 " fill="#FFFF00" filter="url(#f1jp1rbgdo1kgi)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M390,388.3125 L390,394.3125 L396,394.3125 L390,388.3125 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="239.4" y="398.8535">{</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="36.6" x="239.4" y="408.0399">Messages</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="56.4" x="239.4" y="417.2262">"state": "open",</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="147.6" x="239.4" y="426.4125">"reason": "motivation for new Window."</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="239.4" y="435.5988">}</text><polygon fill="#FFFFE0" filter="url(#f1jp1rbgdo1kgi)" points="598.8,448.6442,717.6,448.6442,723.6,460.0442,717.6,471.4442,598.8,471.4442,592.8,460.0442,598.8,448.6442" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="69.6" x="600" y="458.5852">settlementWindow</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="116.4" x="600" y="467.7715">settlementWindowStateChange</text><polygon fill="#A80036" points="239.4,485.0168,233.4,487.4168,239.4,489.8168,237,487.4168" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="235.8" x2="451.8" y1="487.4168" y2="487.4168"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="243" y="484.7578">7</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="57" x="250.8" y="484.7578">Return success</text><polygon fill="#A80036" points="57.6,502.6031,51.6,505.0031,57.6,507.4031,55.2,505.0031" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="54" x2="226.2" y1="505.0031" y2="505.0031"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="61.2" y="502.3442">8</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="153.6" x="69" y="502.3442">Return Success/Results in agreed format</text><line style="stroke: #000000; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="13.8" x2="729.6" y1="510.5895" y2="510.5895"/><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="103.8" x="16.8" y="516.9703">[Settlement Window not found]</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="232.8" x2="258" y1="531.7488" y2="531.7488"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="258" x2="258" y1="531.7488" y2="539.5488"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="233.4" x2="258" y1="539.5488" y2="539.5488"/><polygon fill="#A80036" points="239.4,537.1488,233.4,539.5488,239.4,541.9488,237,539.5488" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="237" y="528.9035">9</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="63.6" x="244.8" y="528.9035">Update event log</text><path d="M235.8,547.3488 L235.8,580.3489 L450.6,580.3489 L450.6,553.3489 L444.6,547.3488 L235.8,547.3488 " fill="#ADD8E6" filter="url(#f1jp1rbgdo1kgi)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M444.6,547.3488 L444.6,553.3489 L450.6,553.3489 L444.6,547.3488 " fill="#ADD8E6" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="82.2" x="239.4" y="557.8899">Log ERROR Messages.</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="111.6" x="239.4" y="567.0762">Update Event log with ERROR.</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="202.2" x="239.4" y="576.2625">Continue process by opening new settlementWindow.</text><polygon fill="#A80036" points="57.6,596.5078,51.6,598.9078,57.6,601.3078,55.2,598.9078" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="54" x2="226.2" y1="598.9078" y2="598.9078"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="61.2" y="596.2489">10</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="138" x="74.4" y="596.2489">Notification of unsuccessful request</text><!--
@startuml
title 6.1.2. POST:: closeSettlementWindow

autonumber



actor "Hub Employee" as OPERATOR

boundary "Settlement Service API" as SSAPI
control "Settlement Window" as SETTLEWINDOW
entity "Settlement Window DAO" as SETTLEWINDOW_DAO

boundary "Central Service API" as CSAPI
database "Central Store" as DB

box "Central HUB" #LightPink
    participant OPERATOR
end box

box "Settlement Service" #LightGreen
    participant SSAPI
    participant SETTLEWINDOW
    participant SETTLEWINDOW_DAO
end box

box "Central Services" #LightYellow
    participant CSAPI
    participant DB
end box


group Request closure of Settlement Window
    OPERATOR -> SETTLEWINDOW: API call for settlement window closure
    note left of SETTLEWINDOW #Yellow
        Messages
        POST:: '/settlementWindows/{id}'

        {
          "state": "closed",
          "reason": "motivation for closure."
        }
    end note

    activate SETTLEWINDOW
    alt
    SETTLEWINDOW -> SETTLEWINDOW_DAO: Request settlementWindow status == 'close'
    activate SETTLEWINDOW_DAO
        SETTLEWINDOW_DAO - -> DB: Update settlementWindow status == 'close' \n<color #FF0000><b>Error code:</b> 2001</color>
    activate DB
        hnote over DB #LightYellow
        settlementWindow
        settlementWindowStateChange
        end hnote
    deactivate DB
    SETTLEWINDOW <- SETTLEWINDOW_DAO: Return success
    deactivate SETTLEWINDOW_DAO

    SETTLEWINDOW -> SETTLEWINDOW_DAO: Request new settlementWindow && status == 'open'
    activate SETTLEWINDOW_DAO
        SETTLEWINDOW_DAO - -> DB: Create new settlementWindow status == 'open' \n<color #FF0000><b>Error code:</b> 2001</color>
    activate DB
        note right of SETTLEWINDOW #Yellow
        {
        Messages
        "state": "open",
        "reason": "motivation for new Window."
        }
        end note
        hnote over DB #LightYellow
        settlementWindow
        settlementWindowStateChange
        end hnote
    deactivate DB
    SETTLEWINDOW <- SETTLEWINDOW_DAO: Return success
    deactivate SETTLEWINDOW_DAO
    OPERATOR <- SETTLEWINDOW: Return Success/Results in agreed format
    else Settlement Window not found
    SETTLEWINDOW -> SETTLEWINDOW: Update event log
        note right of SETTLEWINDOW #LightBlue
        Log ERROR Messages.
        Update Event log with ERROR.
        Continue process by opening new settlementWindow.
        end note
    OPERATOR <- SETTLEWINDOW: Notification of unsuccessful request
    end
end
@enduml

PlantUML version 1.2018.01(Sun Jan 28 20:08:22 SAST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1136-b29
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>