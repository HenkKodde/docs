<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1833.0001px" preserveAspectRatio="none" style="width:1058px;height:1833px;" version="1.1" viewBox="0 0 1058 1833" width="1058.4px" zoomAndPan="magnify"><defs><filter height="300%" id="f1rodyj631ylnj" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="1.2000000476837158"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="2.4000000953674316" dy="2.4000000953674316" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="244.2" x="407.4" y="14.1211">6.2.5. updateSettlementById PUT: /updateSettlementById</text><rect fill="#FFB6C1" height="1805.9954" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="67.2" x="11.4" y="20.693"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="48.6" x="20.7" y="28.234">Central HUB</text><rect fill="#90EE90" height="1805.9954" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="436.5" x="170.7" y="20.693"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="74.4" x="351.75" y="28.234">Settlement Service</text><rect fill="#FFFFE0" height="1805.9954" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="68.4" x="813" y="20.693"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="64.8" x="814.8" y="28.234">Central Services</text><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="216.1266" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="42" y="88.3723"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="17.5863" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="217.2" y="304.4988"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="325.9488" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="217.2" y="1202.2922"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="145.2633" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="217.2" y="1614.3458"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="17.5863" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="392.4" y="322.0852"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="17.5863" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="392.4" y="1184.7059"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="17.5863" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="392.4" y="1596.7594"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="1257.0879" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="567.6" y="339.6715"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="46.9453" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="844.2" y="366.2578"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="37.5727" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="844.2" y="568.4801"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="46.9453" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="844.2" y="632.6391"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="144.0223" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="844.2" y="1023.0973"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="1672.0231" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="1043.4" x="7.8" y="92.5723"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="129.2906" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="430.2" x="474" y="422.3895"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="68.5453" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="367.8" x="530.4" y="436.9758"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="215.4223" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="472.8" x="474" y="688.7707"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="154.677" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="416.4" x="524.4" y="703.3571"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="54.1453" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="274.2" x="530.4" y="776.1024"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="84.7043" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="463.8" x="530.4" y="912.593"/><rect fill="#FFFFFF" height="231.368" style="stroke: none; stroke-width: 0.6000000238418579;" width="1043.4" x="7.8" y="1533.2274"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="45" x2="45" y1="82.3723" y2="1774.7954"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="219.9" x2="219.9" y1="82.3723" y2="1774.7954"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="395.1" x2="395.1" y1="82.3723" y2="1774.7954"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="570.6" x2="570.6" y1="82.3723" y2="1774.7954"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="847.2" x2="847.2" y1="82.3723" y2="1774.7954"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="58.8" x="13.8" y="80.6004">Hub Employee</text><ellipse cx="45" cy="38.2793" fill="#FEFECE" filter="url(#f1rodyj631ylnj)" rx="4.8" ry="4.8" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><path d="M45,43.0793 L45,59.2793 M37.2,47.8793 L52.8,47.8793 M45,59.2793 L37.2,68.2793 M45,59.2793 L52.8,68.2793 " fill="none" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="58.8" x="13.8" y="1782.3165">Hub Employee</text><ellipse cx="45" cy="1790.0884" fill="#FEFECE" filter="url(#f1rodyj631ylnj)" rx="4.8" ry="4.8" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><path d="M45,1794.8884 L45,1811.0884 M37.2,1799.6884 L52.8,1799.6884 M45,1811.0884 L37.2,1820.0884 M45,1811.0884 L52.8,1820.0884 " fill="none" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="90.6" x="173.1" y="80.6004">Settlement Service API</text><path d="M207.9,55.6793 L207.9,70.0793 M207.9,62.8793 L218.1,62.8793 " fill="none" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><ellipse cx="225.3" cy="62.8793" fill="#FEFECE" filter="url(#f1rodyj631ylnj)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="90.6" x="173.1" y="1782.3165">Settlement Service API</text><path d="M207.9,1786.4884 L207.9,1800.8884 M207.9,1793.6884 L218.1,1793.6884 " fill="none" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><ellipse cx="225.3" cy="1793.6884" fill="#FEFECE" filter="url(#f1rodyj631ylnj)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="43.8" x="371.7" y="80.6004">Settlement</text><ellipse cx="395.4" cy="62.8793" fill="#FEFECE" filter="url(#f1rodyj631ylnj)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><polygon fill="#A80036" points="393,55.6793,396.6,52.6793,395.4,55.6793,396.6,58.6793,393,55.6793" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="43.8" x="371.7" y="1782.3165">Settlement</text><ellipse cx="395.4" cy="1793.6884" fill="#FEFECE" filter="url(#f1rodyj631ylnj)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><polygon fill="#A80036" points="393,1786.4884,396.6,1783.4884,395.4,1786.4884,396.6,1789.4884,393,1786.4884" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="64.8" x="536.4" y="80.6004">Settlement DAO</text><ellipse cx="570.6" cy="62.8793" fill="#FEFECE" filter="url(#f1rodyj631ylnj)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><line style="stroke: #A80036; stroke-width: 1.2000000476837158;" x1="563.4" x2="577.8" y1="71.2793" y2="71.2793"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="64.8" x="536.4" y="1782.3165">Settlement DAO</text><ellipse cx="570.6" cy="1793.6884" fill="#FEFECE" filter="url(#f1rodyj631ylnj)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><line style="stroke: #A80036; stroke-width: 1.2000000476837158;" x1="563.4" x2="577.8" y1="1802.0884" y2="1802.0884"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="54" x="818.4" y="80.6004">Central Store</text><path d="M836.4,50.8793 C836.4,44.8793 847.2,44.8793 847.2,44.8793 C847.2,44.8793 858,44.8793 858,50.8793 L858,66.4793 C858,72.4793 847.2,72.4793 847.2,72.4793 C847.2,72.4793 836.4,72.4793 836.4,66.4793 L836.4,50.8793 " fill="#FEFECE" filter="url(#f1rodyj631ylnj)" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><path d="M836.4,50.8793 C836.4,56.8793 847.2,56.8793 847.2,56.8793 C847.2,56.8793 858,56.8793 858,50.8793 " fill="none" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="54" x="818.4" y="1782.3165">Central Store</text><path d="M836.4,1790.0884 C836.4,1784.0884 847.2,1784.0884 847.2,1784.0884 C847.2,1784.0884 858,1784.0884 858,1790.0884 L858,1805.6884 C858,1811.6884 847.2,1811.6884 847.2,1811.6884 C847.2,1811.6884 836.4,1811.6884 836.4,1805.6884 L836.4,1790.0884 " fill="#FEFECE" filter="url(#f1rodyj631ylnj)" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><path d="M836.4,1790.0884 C836.4,1796.0884 847.2,1796.0884 847.2,1796.0884 C847.2,1796.0884 858,1796.0884 858,1790.0884 " fill="none" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="216.1266" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="42" y="88.3723"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="17.5863" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="217.2" y="304.4988"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="325.9488" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="217.2" y="1202.2922"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="145.2633" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="217.2" y="1614.3458"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="17.5863" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="392.4" y="322.0852"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="17.5863" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="392.4" y="1184.7059"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="17.5863" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="392.4" y="1596.7594"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="1257.0879" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="567.6" y="339.6715"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="46.9453" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="844.2" y="366.2578"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="37.5727" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="844.2" y="568.4801"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="46.9453" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="844.2" y="632.6391"/><rect fill="#FFFFFF" filter="url(#f1rodyj631ylnj)" height="144.0223" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="844.2" y="1023.0973"/><path d="M7.8,92.5723 L176.4,92.5723 L176.4,96.7723 L170.4,102.7723 L7.8,102.7723 L7.8,92.5723 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="1672.0231" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="1043.4" x="7.8" y="92.5723"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="141.6" x="16.8" y="100.7133">Acknowledgement of settlement(s)</text><path d="M51,105.9586 L51,285.9586 L193.2,285.9586 L193.2,111.9586 L187.2,105.9586 L51,105.9586 " fill="#FFFF00" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M187.2,105.9586 L187.2,111.9586 L193.2,111.9586 L187.2,105.9586 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="54.6" y="116.4996">{</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="58.2" x="54.6" y="125.6859">"participants": [</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="64.2" y="134.8723">{</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="22.8" x="64.2" y="144.0586">"id": 0</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="49.8" x="64.2" y="153.2449">"accounts" : [</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="73.8" y="162.4313">{</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="25.2" x="73.8" y="171.6176">"id": 0,</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="110.4" x="73.8" y="180.8039">"reason": "motivation blabla",</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="67.8" x="73.8" y="189.9902">"state": "SETTLED"</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="4.8" x="73.8" y="199.1766">},</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="73.8" y="208.3629">{</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="25.2" x="73.8" y="217.5492">"id": 0,</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="110.4" x="73.8" y="226.7356">"reason": "motivation blabla",</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="67.8" x="73.8" y="235.9219">"state": "SETTLED"</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="73.8" y="245.1082">}</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="64.2" y="254.2945">]</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="64.2" y="263.4809">}</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="54.6" y="272.6672">]</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="54.6" y="281.8535">}</text><polygon fill="#A80036" points="210,302.0988,216,304.4988,210,306.8988,212.4,304.4988" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="45" x2="213.6" y1="304.4988" y2="304.4988"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="49.2" y="301.8399">1</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="84.6" x="57" y="301.8399">PUT - /settlement/{id}</text><polygon fill="#A80036" points="385.2,319.6852,391.2,322.0852,385.2,324.4852,387.6,322.0852" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="220.2" x2="388.8" y1="322.0852" y2="322.0852"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="224.4" y="319.4262">2</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="69" x="232.2" y="319.4262">Update settlement</text><polygon fill="#A80036" points="560.4,337.2715,566.4,339.6715,560.4,342.0715,562.8,339.6715" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="395.4" x2="564" y1="339.6715" y2="339.6715"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="399.6" y="337.0125">3</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="69" x="407.4" y="337.0125">Update settlement</text><polygon fill="#A80036" points="837,363.8578,843,366.2578,837,368.6578,839.4,366.2578" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="573.6" x2="840.6" y1="366.2578" y2="366.2578"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="577.8" y="359.192">4</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="108" x="585.6" y="354.5988">Lookup settlement and state</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43.8" x="585.6" y="363.7852">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="631.8" y="363.7852">2001</text><polygon fill="#FFFFE0" filter="url(#f1rodyj631ylnj)" points="802.2,374.4305,891.6,374.4305,897.6,385.8305,891.6,397.2305,802.2,397.2305,796.2,385.8305,802.2,374.4305" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="40.2" x="803.4" y="384.3715">settlement</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="87" x="803.4" y="393.5578">settlementStateChange</text><polygon fill="#A80036" points="580.2,410.8031,574.2,413.2031,580.2,415.6031,577.8,413.2031" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="576.6" x2="846.6" y1="413.2031" y2="413.2031"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="583.8" y="410.5442">5</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="67.2" x="591.6" y="410.5442">Return Settlement</text><path d="M474,422.3895 L524.4,422.3895 L524.4,426.5895 L518.4,432.5895 L474,432.5895 L474,422.3895 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="129.2906" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="430.2" x="474" y="422.3895"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23.4" x="483" y="430.5305">break</text><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80.4" x="533.4" y="429.9703">[Verify settlement state]</text><path d="M530.4,436.9758 L615.6,436.9758 L615.6,441.1758 L609.6,447.1758 L530.4,447.1758 L530.4,436.9758 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="68.5453" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="367.8" x="530.4" y="436.9758"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="58.2" x="539.4" y="445.1168">Validate event</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="573.6" x2="598.8" y1="469.3348" y2="469.3348"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="598.8" x2="598.8" y1="469.3348" y2="477.1348"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="574.2" x2="598.8" y1="477.1348" y2="477.1348"/><polygon fill="#A80036" points="580.2,474.7348,574.2,477.1348,580.2,479.5348,577.8,477.1348" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="577.8" y="461.8963">6</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="249" x="585.6" y="457.3031">Validate event - Rule: settlementState == 'PENDING_SETTLEMENT'</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43.8" x="585.6" y="466.4895">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="631.8" y="466.4895">2001</text><path d="M576.6,484.9348 L576.6,499.9348 L889.8,499.9348 L889.8,490.9348 L883.8,484.9348 L576.6,484.9348 " fill="#D3D3D3" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M883.8,484.9348 L883.8,490.9348 L889.8,490.9348 L883.8,484.9348 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="580.2" y="495.4758">Condition</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="261.6" x="619.2" y="495.4758">: Continue if true, otherwise set ERROR response code == '401' break</text><path d="M480,512.7211 L480,545.7211 L562.2,545.7211 L562.2,518.7211 L556.2,512.7211 L480,512.7211 " fill="#FF0000" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M556.2,512.7211 L556.2,518.7211 L562.2,518.7211 L556.2,512.7211 " fill="#FF0000" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="69.6" x="483.6" y="523.2621">Validation failure</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="17.4" x="483.6" y="532.4485">goto</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60.6" x="483.6" y="541.6348">Process ERROR</text><polygon fill="#A80036" points="837,566.0801,843,568.4801,837,570.8801,839.4,568.4801" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="573.6" x2="840.6" y1="568.4801" y2="568.4801"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="577.8" y="565.8211">7</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="71.4" x="585.6" y="565.8211">Lookup participant</text><polygon fill="#FFFFE0" filter="url(#f1rodyj631ylnj)" points="817.2,576.4664,877.2,576.4664,883.2,583.0664,877.2,590.2664,817.2,590.2664,811.2,583.0664,817.2,576.4664" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="818.4" y="586.4074">Tables effected</text><polygon fill="#A80036" points="580.2,603.6528,574.2,606.0528,580.2,608.4528,577.8,606.0528" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="576.6" x2="846.6" y1="606.0528" y2="606.0528"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="583.8" y="603.3938">8</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="91.2" x="591.6" y="603.3938">Return participant detail</text><polygon fill="#A80036" points="837,630.2391,843,632.6391,837,635.0391,839.4,632.6391" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="573.6" x2="840.6" y1="632.6391" y2="632.6391"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="577.8" y="625.5733">9</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="135.6" x="585.6" y="620.9801">Retrieve list of requested account(s)</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43.8" x="585.6" y="630.1664">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="631.8" y="630.1664">2001</text><polygon fill="#FFFFE0" filter="url(#f1rodyj631ylnj)" points="765.6,640.8117,928.8,640.8117,934.8,652.2117,928.8,663.6117,765.6,663.6117,759.6,652.2117,765.6,640.8117" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="114" x="766.8" y="650.7528">settlementParticipantCurrency</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="160.8" x="766.8" y="659.9391">settlementParticipantCurrencyStateChange</text><polygon fill="#A80036" points="580.2,677.1844,574.2,679.5844,580.2,681.9844,577.8,679.5844" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="576.6" x2="846.6" y1="679.5844" y2="679.5844"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="583.8" y="676.9254">10</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="39" x="597" y="676.9254">Return list</text><path d="M474,688.7707 L524.4,688.7707 L524.4,692.9707 L518.4,698.9707 L474,698.9707 L474,688.7707 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="215.4223" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="472.8" x="474" y="688.7707"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23.4" x="483" y="696.9117">break</text><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="100.2" x="533.4" y="696.3516">[validate list of account state]</text><path d="M524.4,703.3571 L609.6,703.3571 L609.6,707.5571 L603.6,713.5571 L524.4,713.5571 L524.4,703.3571 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="154.677" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="416.4" x="524.4" y="703.3571"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="58.2" x="533.4" y="711.4981">Validate event</text><path d="M576.6,716.7434 L576.6,731.7434 L646.8,731.7434 L646.8,722.7434 L640.8,716.7434 L576.6,716.7434 " fill="#D3D3D3" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M640.8,716.7434 L640.8,722.7434 L646.8,722.7434 L640.8,716.7434 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="580.2" y="727.2844">validList = true</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="573.6" x2="598.8" y1="759.3024" y2="759.3024"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="598.8" x2="598.8" y1="759.3024" y2="767.1024"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="574.2" x2="598.8" y1="767.1024" y2="767.1024"/><polygon fill="#A80036" points="580.2,764.7024,574.2,767.1024,580.2,769.5024,577.8,767.1024" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="577.8" y="751.8639">11</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="150.6" x="591" y="747.2707">Validate event - Rule: validList == 'true'</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43.8" x="591" y="756.4571">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="637.2" y="756.4571">2001</text><path d="M530.4,776.1024 L574.8,776.1024 L574.8,780.3024 L568.8,786.3024 L530.4,786.3024 L530.4,776.1024 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="54.1453" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="274.2" x="530.4" y="776.1024"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17.4" x="539.4" y="784.2434">loop</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="573.6" x2="598.8" y1="817.6477" y2="817.6477"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="598.8" x2="598.8" y1="817.6477" y2="825.4477"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="574.2" x2="598.8" y1="825.4477" y2="825.4477"/><polygon fill="#A80036" points="580.2,823.0477,574.2,825.4477,580.2,827.8477,577.8,825.4477" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="577.8" y="805.616">12</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="204" x="591" y="796.4297">if participantCurrencyState != 'PENDING_SETTLEMENT'</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="79.8" x="591" y="805.616">then validList = false</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43.8" x="591" y="814.8024">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="637.2" y="814.8024">2001</text><path d="M576.6,837.4477 L576.6,852.4477 L932.4,852.4477 L932.4,843.4477 L926.4,837.4477 L576.6,837.4477 " fill="#D3D3D3" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M926.4,837.4477 L926.4,843.4477 L932.4,843.4477 L926.4,837.4477 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="580.2" y="847.9887">Condition</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="304.2" x="619.2" y="847.9887">: Continue if validList = true, otherwise set ERROR response code == '401' break</text><path d="M480,865.234 L480,898.234 L562.2,898.234 L562.2,871.234 L556.2,865.234 L480,865.234 " fill="#FF0000" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M556.2,865.234 L556.2,871.234 L562.2,871.234 L556.2,865.234 " fill="#FF0000" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="69.6" x="483.6" y="875.775">Validation failure</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="17.4" x="483.6" y="884.9614">goto</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60.6" x="483.6" y="894.1477">Process ERROR</text><path d="M530.4,912.593 L629.4,912.593 L629.4,916.793 L623.4,922.793 L530.4,922.793 L530.4,912.593 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="84.7043" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="463.8" x="530.4" y="912.593"/><text fill="#0000FF" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="539.4" y="920.734">DB TRANSACTION</text><polygon fill="#A80036" points="840,942.1793,846,944.5793,840,946.9793,842.4,944.5793" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="573.6" x2="843.6" y1="944.5793" y2="944.5793"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="577.8" y="937.5135">13</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="123" x="591" y="932.9203">Update participant account state</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43.8" x="591" y="942.1067">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="637.2" y="942.1067">2001</text><polygon fill="#FFFFE0" filter="url(#f1rodyj631ylnj)" points="712.2,952.752,982.2,952.752,988.2,973.152,982.2,994.152,712.2,994.152,706.2,973.152,712.2,952.752" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="48" x="713.4" y="962.693">INSERT INTO</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="175.2" x="763.8" y="962.693">settlementParticipantCurrencyStateChange</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="267.6" x="713.4" y="971.8793">SELECT settlementParticipantCurrencyId, payload.state, payload.reason</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="138" x="713.4" y="981.0657">FROM settlementParticipantCurrency</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="165.6" x="713.4" y="990.252">WHERE settlementId = payload.settlementId</text><polygon fill="#A80036" points="837,1020.6973,843,1023.0973,837,1025.4973,839.4,1023.0973" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="573.6" x2="840.6" y1="1023.0973" y2="1023.0973"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="577.8" y="1016.0315">14</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="189" x="591" y="1011.4383">Obtain list of Participants and settlementWindows</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43.8" x="591" y="1020.6246">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="637.2" y="1020.6246">2001</text><polygon fill="#FFFFE0" filter="url(#f1rodyj631ylnj)" points="738.6,1031.27,955.2,1031.27,961.2,1065.47,955.2,1100.27,738.6,1100.27,732.6,1065.47,738.6,1031.27" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="91.2" x="739.8" y="1041.211">SELECT pc.participantId </text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="168" x="739.8" y="1050.3973">FROM settlementParticipantCurrency AS spc </text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="131.4" x="739.8" y="1059.5836">JOIN participantCurrency AS pc ON</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="203.4" x="749.4" y="1068.77">pc.participantCurrencyId = spc.participantCurrencyId </text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="195.6" x="739.8" y="1077.9563">WHERE spc.settlementId = payload.settlement&lt;id&gt; </text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="204.6" x="749.4" y="1087.1426">AND pc.participantCurrencyId = payload.account&lt;id&gt;</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="164.4" x="739.8" y="1096.3289">GROUP BY participantCurrency.participantId</text><path d="M649.2,1106.3743 L649.2,1148.9743 L1042.8,1148.9743 L1042.8,1112.3743 L1036.8,1106.3743 L649.2,1106.3743 " fill="#D3D3D3" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M1036.8,1106.3743 L1036.8,1112.3743 L1042.8,1112.3743 L1036.8,1106.3743 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="198.6" x="652.8" y="1116.9153">Response back for the account(s) updated to include</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="381" x="652.8" y="1126.1016">settlementWindowId, settlementWindowState, settlementWindowState,settlementWindowCreatedDate</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="50.4" x="652.8" y="1135.2879">participantId,</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="273" x="652.8" y="1144.4743">account&lt;id&gt;(participantCurrencyId), reason, state, netAmount, currency</text><polygon fill="#A80036" points="580.2,1164.7196,574.2,1167.1196,580.2,1169.5196,577.8,1167.1196" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="576.6" x2="846.6" y1="1167.1196" y2="1167.1196"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="583.8" y="1164.4606">15</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="123.6" x="597" y="1164.4606">Return updated list of account(s)</text><polygon fill="#A80036" points="405,1182.3059,399,1184.7059,405,1187.1059,402.6,1184.7059" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="401.4" x2="567" y1="1184.7059" y2="1184.7059"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="408.6" y="1182.0469">16</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="144.6" x="421.8" y="1182.0469">Account settlement update successful</text><polygon fill="#A80036" points="229.8,1199.8922,223.8,1202.2922,229.8,1204.6922,227.4,1202.2922" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="226.2" x2="394.8" y1="1202.2922" y2="1202.2922"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="233.4" y="1199.6333">17</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="144.6" x="246.6" y="1199.6333">Account settlement update successful</text><path d="M75,1210.2786 L75,1509.6786 L211.8,1509.6786 L211.8,1216.2786 L205.8,1210.2786 L75,1210.2786 " fill="#FFFFE0" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M205.8,1210.2786 L205.8,1216.2786 L211.8,1216.2786 L205.8,1210.2786 " fill="#FFFFE0" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="78.6" y="1220.8196">[</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="83.4" y="1230.0059">{</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="25.2" x="88.2" y="1239.1922">"Id": 0,</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="60" x="88.2" y="1248.3786">"State": "string",</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="87" x="88.2" y="1257.5649">"settlementWindows": [</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="93" y="1266.7512">[</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="97.8" y="1275.9376">{</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="25.2" x="102.6" y="1285.1239">"id": 0,</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="66.6" x="102.6" y="1294.3102">"reason": "string",</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="60" x="102.6" y="1303.4965">"state": "string",</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="86.4" x="102.6" y="1312.6829">"createdDate": "string",</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="97.8" y="1321.8692">}</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="93" y="1331.0555">]</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="4.8" x="88.2" y="1340.2419">],</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="88.2" y="1349.4282">"Participants": [</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="93" y="1358.6145">{</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="25.2" x="97.8" y="1367.8008">"id": 0,</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="47.4" x="97.8" y="1376.9872">"accounts": [</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="102.6" y="1386.1735">{</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="48.6" x="107.4" y="1395.3598">"id": "string",</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="66.6" x="107.4" y="1404.5461">"reason": "string",</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="70.2" x="107.4" y="1413.7325">"state": "SETTLED",</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="95.4" x="107.4" y="1422.9188">"netSettlementAmount": {</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="46.8" x="112.2" y="1432.1051">"amount": 0,</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="71.4" x="112.2" y="1441.2915">"currency": "string"</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="107.4" y="1450.4778">}</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="102.6" y="1459.6641">}</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="97.8" y="1468.8504">]</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="93" y="1478.0368">}</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="88.2" y="1487.2231">]</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="83.4" y="1496.4094">}</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="78.6" y="1505.5958">]</text><polygon fill="#A80036" points="51.6,1525.8411,45.6,1528.2411,51.6,1530.6411,49.2,1528.2411" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="48" x2="219.6" y1="1528.2411" y2="1528.2411"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="55.2" y="1525.5821">18</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="144.6" x="68.4" y="1525.5821">Account settlement update successful</text><line style="stroke: #000000; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="7.8" x2="1051.2" y1="1533.8274" y2="1533.8274"/><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="10.8" y="1540.2083">[</text><text fill="#FF0000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45.6" x="13.2" y="1540.2083">Error Process</text><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="58.8" y="1540.2083">]</text><path d="M489,1545.2005 L489,1578.2005 L562.2,1578.2005 L562.2,1551.2005 L556.2,1545.2005 L489,1545.2005 " fill="#FF0000" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M556.2,1545.2005 L556.2,1551.2005 L562.2,1551.2005 L556.2,1545.2005 " fill="#FF0000" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="0" x="495" y="1555.7415"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60.6" x="492.6" y="1564.9278">Process ERROR</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="0" x="495" y="1574.1141"/><polygon fill="#A80036" points="405,1594.3594,399,1596.7594,405,1599.1594,402.6,1596.7594" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="401.4" x2="570" y1="1596.7594" y2="1596.7594"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="408.6" y="1594.1005">19</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="58.8" x="421.8" y="1594.1005">Return - ERROR</text><polygon fill="#A80036" points="229.8,1611.9458,223.8,1614.3458,229.8,1616.7458,227.4,1614.3458" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="226.2" x2="394.8" y1="1614.3458" y2="1614.3458"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="233.4" y="1611.6868">20</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="58.8" x="246.6" y="1611.6868">Return - ERROR</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="223.2" x2="248.4" y1="1632.1184" y2="1632.1184"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="248.4" x2="248.4" y1="1632.1184" y2="1639.9184"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="223.8" x2="248.4" y1="1639.9184" y2="1639.9184"/><polygon fill="#A80036" points="229.8,1637.5184,223.8,1639.9184,229.8,1642.3184,227.4,1639.9184" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="227.4" y="1629.2731">21</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="63.6" x="240.6" y="1629.2731">Update Event log</text><path d="M226.2,1647.7184 L226.2,1671.7184 L350.4,1671.7184 L350.4,1653.7184 L344.4,1647.7184 L226.2,1647.7184 " fill="#ADD8E6" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M344.4,1647.7184 L344.4,1653.7184 L350.4,1653.7184 L344.4,1647.7184 " fill="#ADD8E6" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="82.2" x="229.8" y="1658.2594">Log ERROR Messages.</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="111.6" x="229.8" y="1667.4458">Update Event log with ERROR.</text><path d="M44.4,1680.4911 L44.4,1741.0911 L211.8,1741.0911 L211.8,1686.4911 L205.8,1680.4911 L44.4,1680.4911 " fill="#FFFF00" filter="url(#f1rodyj631ylnj)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M205.8,1680.4911 L205.8,1686.4911 L211.8,1686.4911 L205.8,1680.4911 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="48" y="1691.0321">{</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="41.4" x="52.8" y="1700.2184">"status": 0,</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="150" x="52.8" y="1709.4048">"code": "(ERROR response code eg. '404'</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="121.8" x="76.8" y="1718.5911">Defined in swagger definition))",</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="72" x="52.8" y="1727.7774">"message": "string"</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="48" y="1736.9637">}</text><polygon fill="#A80036" points="51.6,1757.2091,45.6,1759.6091,51.6,1762.0091,49.2,1759.6091" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="48" x2="219.6" y1="1759.6091" y2="1759.6091"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="55.2" y="1756.9501">22</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="51.6" x="68.4" y="1756.9501">Return ERROR</text><!--
@startuml
title 6.2.5. updateSettlementById PUT: /updateSettlementById
autonumber



actor "Hub Employee" as OPERATOR

boundary "Settlement Service API" as SSAPI
control "Settlement" as SETTLEMENT
entity "Settlement DAO" as SETTLE_DAO

database "Central Store" as DB

box "Central HUB" #LightPink
    participant OPERATOR
end box

box "Settlement Service" #LightGreen
    participant SSAPI
    participant SETTLEMENT
    participant SETTLE_DAO
end box

box "Central Services" #LightYellow
    participant DB
end box

group Acknowledgement of settlement(s)
    activate OPERATOR
    note right of OPERATOR #Yellow
        {
        "participants": [
            {
            "id": 0
            "accounts" : [
                {
                "id": 0,
                "reason": "motivation blabla",
                "state": "SETTLED"
                },
                {
                "id": 0,
                "reason": "motivation blabla",
                "state": "SETTLED"
                }
            ]
            }
        ]
        }
    end note
    OPERATOR -> SSAPI: PUT - /settlement/{id}
    deactivate OPERATOR
    activate SSAPI
    SSAPI -> SETTLEMENT: Update settlement
    deactivate SSAPI
    activate SETTLEMENT
    SETTLEMENT -> SETTLE_DAO: Update settlement
    deactivate SETTLEMENT
    activate SETTLE_DAO
    SETTLE_DAO -> DB: Lookup settlement and state \n<color #FF0000><b>Error code:</b> 2001</color>
    activate DB
    hnote over DB #LightYellow
        settlement
        settlementStateChange
    end hnote
    SETTLE_DAO <- - DB: Return Settlement
    deactivate DB

    break Verify settlement state
        group Validate event
            SETTLE_DAO <-> SETTLE_DAO:  Validate event - Rule: settlementState == 'PENDING_SETTLEMENT' \n<color #FF0000><b>Error code:</b> 2001</color>
            note right of SETTLE_DAO #lightgray
                **Condition**: Continue if true, otherwise set ERROR response code == '401' break
            end note
        end
        note left of SETTLE_DAO #Red
            **Validation failure**
            goto
            **Process ERROR**
        end note
    end

    SETTLE_DAO -> DB: Lookup participant
    activate DB
    hnote over DB #LightYellow
        Tables effected
    end hnote
    SETTLE_DAO <- - DB: Return participant detail
    deactivate DB
    SETTLE_DAO -> DB: Retrieve list of requested account(s) \n<color #FF0000><b>Error code:</b> 2001</color>
    activate DB
    hnote over DB #LightYellow
        settlementParticipantCurrency
        settlementParticipantCurrencyStateChange
    end hnote
    SETTLE_DAO <- - DB: Return list
    deactivate DB

    break validate list of account state
        group Validate event
            note right of SETTLE_DAO #LightGray
                validList = true
            end note
            SETTLE_DAO <-> SETTLE_DAO: Validate event - Rule: validList == 'true' \n<color #FF0000><b>Error code:</b> 2001</color>
            loop
                SETTLE_DAO <-> SETTLE_DAO: if participantCurrencyState != 'PENDING_SETTLEMENT' \nthen validList = false \n<color #FF0000><b>Error code:</b> 2001</color>
            end loop
            note right of SETTLE_DAO #LightGray
                **Condition**: Continue if validList = true, otherwise set ERROR response code == '401' break
            end note
        end
        note left of SETTLE_DAO #Red
            **Validation failure**
            goto
            **Process ERROR**
        end note
    end

    group <color #blue>DB TRANSACTION</color>
        SETTLE_DAO -> DB: Update participant account state \n<color #FF0000><b>Error code:</b> 2001</color>
        hnote over DB #LightYellow
            INSERT INTO **settlementParticipantCurrencyStateChange**
            SELECT settlementParticipantCurrencyId, payload.state, payload.reason
            FROM settlementParticipantCurrency
            WHERE settlementId = payload.settlementId
        end hnote
    end

    SETTLE_DAO -> DB: Obtain list of Participants and settlementWindows \n<color #FF0000><b>Error code:</b> 2001</color>
    activate DB
    hnote over DB #LightYellow
        SELECT pc.participantId 
        FROM settlementParticipantCurrency AS spc 
        JOIN participantCurrency AS pc ON
            pc.participantCurrencyId = spc.participantCurrencyId 
        WHERE spc.settlementId = payload.settlement<id> 
            AND pc.participantCurrencyId = payload.account<id>
        GROUP BY participantCurrency.participantId
    end hnote
    note over DB #LightGray
        Response back for the account(s) updated to include
        settlementWindowId, settlementWindowState, settlementWindowState,settlementWindowCreatedDate
        participantId,
        account<id>(participantCurrencyId), reason, state, netAmount, currency
    end note
    SETTLE_DAO <- - DB: Return updated list of account(s)
    deactivate DB
    SETTLEMENT <- SETTLE_DAO: Account settlement update successful
    activate SETTLEMENT
    SSAPI <- SETTLEMENT: Account settlement update successful
    deactivate SETTLEMENT
    activate SSAPI
    note left of SSAPI #LightYellow
        [
          {
            "Id": 0,
            "State": "string",
            "settlementWindows": [
              [
                {
                  "id": 0,
                  "reason": "string",
                  "state": "string",
                  "createdDate": "string",
                }
              ]
            ],
            "Participants": [
              {
                "id": 0,
                "accounts": [
                  {
                    "id": "string",
                    "reason": "string",
                    "state": "SETTLED",
                    "netSettlementAmount": {
                      "amount": 0,
                      "currency": "string"
                    }
                  }
                ]
              }
            ]
          }
        ]
    end note
    SSAPI -> OPERATOR: Account settlement update successful
    deactivate SSAPI

    else <color #FF0000><b>Error Process</b></color>
    note left of SETTLE_DAO #Red

        **Process ERROR**

    end note
    SETTLEMENT <- SETTLE_DAO: Return - ERROR
    deactivate SETTLE_DAO
    activate SETTLEMENT
    SSAPI <- SETTLEMENT: Return - ERROR
    deactivate SETTLEMENT
    activate SSAPI
    SSAPI <-> SSAPI: Update Event log
    note right of SSAPI #LightBlue
        Log ERROR Messages.
        Update Event log with ERROR.
    end note
    note left of SSAPI #Yellow
        {
          "status": 0,
          "code": "(ERROR response code eg. '404'
                    Defined in swagger definition))",
          "message": "string"
        }
    end note
    OPERATOR <- SSAPI: Return ERROR
    deactivate SSAPI
end
@enduml

PlantUML version 1.2018.01(Sun Jan 28 20:08:22 SAST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1136-b29
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>